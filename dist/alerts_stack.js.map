{"version":3,"sources":["../src/alerts_stack.jsx"],"names":["transformAlerts","alerts","defaultStyles","stylesError","map","onActionClick","actionLabel","type","alert","action","onClick","AlertStack","dismissAlert","styles","composer","onData","context","Alerts","i18n","list","fallbackOptions","useFallbackForMissing","showKeyForMissing","nullKeyValue","translate","keyOrKeyArray","translateProps","disableI18n","t","translateAlert","message","title","depsMapper","actions","dismiss"],"mappings":";;;;;;;;;AAAA;;;;AACA;;AACA;;;;;;AAEA;AACA,IAAMA,kBAAkB,SAAlBA,eAAkB,CAACC,MAAD,EAASC,aAAT,EAAwBC,WAAxB;AAAA,SAAwCF,OAAOG,GAAP,CAC9D;AAAA,QAAGC,aAAH,QAAGA,aAAH;AAAA,QAAkBC,WAAlB,QAAkBA,WAAlB;AAAA,QAA+BC,IAA/B,QAA+BA,IAA/B;AAAA,QAAwCC,KAAxC;;AAAA,iCAEON,aAFP,EAGQK,SAAS,OAAT,IAAoBJ,WAH5B,GAKKK,KALL;AAMEC,cAAQH,WANV;AAOEI,eAASL;AAPX;AAAA,GAD8D,CAAxC;AAAA,CAAxB;AAWA,IAAMM,aAAa,SAAbA,UAAa;AAAA,MACfC,YADe,SACfA,YADe;AAAA,MAEfX,MAFe,SAEfA,MAFe;AAAA,MAGfY,MAHe,SAGfA,MAHe;AAAA,MAIfV,WAJe,SAIfA,WAJe;AAAA,SAMf;AACE,mBAAeH,gBAAgBC,MAAhB,EAAwBY,MAAxB,EAAgCV,WAAhC,CADjB;AAEE,eAAWS;AAFb,IANe;AAAA,CAAnB;;AAYO,IAAME,WAAW,SAAXA,QAAW,QAAcC,MAAd,EAAyB;AAAA,MAAtBC,OAAsB,SAAtBA,OAAsB;;AAAA,iBACtBA,SADsB;AAAA,MACvCC,MADuC,YACvCA,MADuC;AAAA,MAC/BC,IAD+B,YAC/BA,IAD+B;;AAE/C,MAAMjB,SAASgB,OAAOE,IAAP,EAAf;AACA;AACA;AACA,MAAMC,kBAAkB;AACtBC,2BAAuB,IADD;AAEtBC,uBAAmB,IAFG;AAGtBC,kBAAc,IAHQ,EAAxB;AAKA,MAAMC,YAAY,SAAZA,SAAY,CAACC,aAAD,EAAgBC,cAAhB,EAAgCC,WAAhC,EAAgD;AAChE,QAAIA,WAAJ,EAAiB;AACf,aAAOF,aAAP;AACD;AACD,WAAOP,KAAKU,CAAL,CAAOH,aAAP,EAAsBC,cAAtB,EAAsCN,eAAtC,CAAP;AACD,GALD;AAMA,MAAMS,iBAAiB,SAAjBA,cAAiB;AAAA,QAAGF,WAAH,SAAGA,WAAH;AAAA,QAAgBG,OAAhB,SAAgBA,OAAhB;AAAA,QAAyBxB,WAAzB,SAAyBA,WAAzB;AAAA,QAAsCyB,KAAtC,SAAsCA,KAAtC;AAAA,QAAgDvB,KAAhD;;AAAA,wBAClBA,KADkB;AAErBsB,eAASN,UAAUM,OAAV,EAAmBtB,KAAnB,EAA0BmB,WAA1B,CAFY;AAGrBI,aAAOP,UAAUO,KAAV,EAAiBvB,KAAjB,EAAwBmB,WAAxB,CAHc;AAIrBrB,mBAAakB,UAAUlB,WAAV,EAAuBE,KAAvB,EAA8BmB,WAA9B;AAJQ;AAAA;AAMvB;AANA;AAQAZ,SAAO,IAAP,EAAa,EAAEd,QAAQA,OAAOG,GAAP,CAAWyB,cAAX,CAAV,EAAb;AACD,CAzBM;;;AA2BA,IAAMG,kCAAa,SAAbA,UAAa,CAAChB,SAAD,EAAUiB,OAAV;AAAA,SAAuB;AAC/CjB,aAAS;AAAA,aAAMA,SAAN;AAAA,KADsC;AAE/CJ,kBAAcqB,QAAQhC,MAAR,CAAeiC;AAFkB,GAAvB;AAAA,CAAnB;;kBAKQ,4BACb,oCAAmBpB,QAAnB,CADa,EAEb,yBAAQkB,UAAR,CAFa,EAGbrB,UAHa,C","file":"alerts_stack.js","sourcesContent":["import React from 'react';\nimport { useDeps, composeAll, composeWithTracker } from 'mantra-core';\nimport { NotificationStack as ReactNotificationStack } from 'react-notification';\n\n// some aliassing for ReactNotificationStack\nconst transformAlerts = (alerts, defaultStyles, stylesError) => alerts.map(\n  ({ onActionClick, actionLabel, type, ...alert }) => ({\n    ...{\n      ...defaultStyles,\n      ...(type === 'error' && stylesError),\n    },\n    ...alert,\n    action: actionLabel,\n    onClick: onActionClick,\n  }),\n);\nconst AlertStack = ({\n    dismissAlert,\n    alerts,\n    styles,\n    stylesError,\n  }) => (\n    <ReactNotificationStack\n      notifications={transformAlerts(alerts, styles, stylesError)}\n      onDismiss={dismissAlert}\n    />\n  );\n\nexport const composer = ({ context }, onData) => {\n  const { Alerts, i18n } = context();\n  const alerts = Alerts.list();\n  // we enforce translations-fallbacks here, because it is not a good idea\n  // to show empty error message\n  const fallbackOptions = {\n    useFallbackForMissing: true,\n    showKeyForMissing: true,\n    nullKeyValue: null, // when a key is not given, dont show anything\n  };\n  const translate = (keyOrKeyArray, translateProps, disableI18n) => {\n    if (disableI18n) {\n      return keyOrKeyArray;\n    }\n    return i18n.t(keyOrKeyArray, translateProps, fallbackOptions);\n  };\n  const translateAlert = ({ disableI18n, message, actionLabel, title, ...alert }) => ({\n    ...alert,\n    message: translate(message, alert, disableI18n),\n    title: translate(title, alert, disableI18n),\n    actionLabel: translate(actionLabel, alert, disableI18n),\n  })\n  // translate alerts\n  ;\n  onData(null, { alerts: alerts.map(translateAlert) });\n};\n\nexport const depsMapper = (context, actions) => ({\n  context: () => context,\n  dismissAlert: actions.alerts.dismiss,\n});\n\nexport default composeAll(\n  composeWithTracker(composer),\n  useDeps(depsMapper),\n)(AlertStack);\n"]}