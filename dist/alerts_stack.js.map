{"version":3,"sources":["../src/alerts_stack.jsx"],"names":[],"mappings":";;;;;;;;;;;;qBAAkB,OAAO;;;;0BAC+B,aAAa;;iCACT,oBAAoB;;sBAClE,QAAQ;;;;;AAGtB,IAAM,eAAe,GAAG,SAAlB,eAAe,CAAI,MAAM,EAAE,aAAa,EAAE,WAAW;SAAK,MAAM,CAAC,GAAG,CACxE,UAAC,IAA8C;QAA5C,aAAa,GAAf,IAA8C,CAA5C,aAAa;QAAE,WAAW,GAA5B,IAA8C,CAA7B,WAAW;QAAE,IAAI,GAAlC,IAA8C,CAAhB,IAAI;;QAAK,KAAK,4BAA5C,IAA8C;;iCAExC,aAAa,EACZ,IAAI,KAAK,OAAO,IAAI,WAAW,GAElC,KAAK;AACR,YAAM,EAAE,WAAW;AACnB,aAAO,EAAE,aAAa;;GACtB,CACH;CAAA,CAAC;AACF,IAAM,UAAU,GAAG,SAAb,UAAU,CAAI,KAKjB;MAJC,YAAY,GADI,KAKjB,CAJC,YAAY;MACZ,MAAM,GAFU,KAKjB,CAHC,MAAM;MACN,MAAM,GAHU,KAKjB,CAFC,MAAM;MACN,WAAW,GAJK,KAKjB,CADC,WAAW;SAEX;AACE,iBAAa,EAAE,eAAe,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,CAAC,AAAC;AAC5D,aAAS,EAAE,YAAY,AAAC;IACxB;CACH,CAAC;;AAEG,IAAM,QAAQ,GAAG,SAAX,QAAQ,CAAI,KAAW,EAAE,MAAM,EAAK;MAAtB,OAAO,GAAT,KAAW,CAAT,OAAO;;kBACP,OAAO,EAAE;;MAA1B,MAAM,aAAN,MAAM;MAAE,IAAI,aAAJ,IAAI;;AACpB,MAAM,MAAM,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC;;;AAG7B,MAAM,eAAe,GAAG;AACtB,yBAAqB,EAAE,IAAI;AAC3B,qBAAiB,EAAE,IAAI;AACvB,gBAAY,EAAE,IAAI,EACnB,CAAC;;AACF,MAAM,SAAS,GAAG,SAAZ,SAAS,CAAI,aAAa,EAAE,cAAc,EAAE,WAAW,EAAK;AAChE,QAAI,WAAW,EAAE;AACf,aAAO,aAAa,CAAC;KACtB;AACD,WAAO,IAAI,CAAC,CAAC,CAAC,aAAa,EAAE,cAAc,EAAE,eAAe,CAAC,CAAC;GAC/D,CAAC;AACF,MAAM,cAAc,GAAG,SAAjB,cAAc,CAAI,KAAsD;QAApD,WAAW,GAAb,KAAsD,CAApD,WAAW;QAAE,OAAO,GAAtB,KAAsD,CAAvC,OAAO;QAAE,WAAW,GAAnC,KAAsD,CAA9B,WAAW;QAAE,KAAK,GAA1C,KAAsD,CAAjB,KAAK;;QAAK,KAAK,4BAApD,KAAsD;;wBACzE,KAAK;AACR,aAAO,EAAE,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE,WAAW,CAAC;AAC/C,WAAK,EAAE,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,WAAW,CAAC;AAC3C,iBAAW,EAAE,SAAS,CAAC,WAAW,EAAE,KAAK,EAAE,WAAW,CAAC;;GACvD;;GAED;AACD,QAAM,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;CACtD,CAAC;;;AAEK,IAAM,UAAU,GAAG,SAAb,UAAU,CAAI,QAAO,EAAE,OAAO;SAAM;AAC/C,WAAO,EAAE;aAAM,QAAO;KAAA;AACtB,gBAAY,EAAE,OAAO,CAAC,MAAM,CAAC,OAAO;GACrC;CAAC,CAAC;;;qBAEY,4BACb,oCAAmB,QAAQ,CAAC,EAC5B,yBAAQ,UAAU,CAAC,CACpB,CAAC,UAAU,CAAC","file":"alerts_stack.js","sourcesContent":["import React from 'react';\nimport { useDeps, composeAll, composeWithTracker } from 'mantra-core';\nimport { NotificationStack as ReactNotificationStack } from 'react-notification';\nimport _ from 'lodash';\n\n// some aliassing for ReactNotificationStack\nconst transformAlerts = (alerts, defaultStyles, stylesError) => alerts.map(\n  ({ onActionClick, actionLabel, type, ...alert }) => ({\n    ...{\n      ...defaultStyles,\n      ...(type === 'error' && stylesError),\n    },\n    ...alert,\n    action: actionLabel,\n    onClick: onActionClick,\n  }),\n);\nconst AlertStack = ({\n    dismissAlert,\n    alerts,\n    styles,\n    stylesError,\n  }) => (\n    <ReactNotificationStack\n      notifications={transformAlerts(alerts, styles, stylesError)}\n      onDismiss={dismissAlert}\n    />\n  );\n\nexport const composer = ({ context }, onData) => {\n  const { Alerts, i18n } = context();\n  const alerts = Alerts.list();\n  // we enforce translations-fallbacks here, because it is not a good idea\n  // to show empty error message\n  const fallbackOptions = {\n    useFallbackForMissing: true,\n    showKeyForMissing: true,\n    nullKeyValue: null, // when a key is not given, dont show anything\n  };\n  const translate = (keyOrKeyArray, translateProps, disableI18n) => {\n    if (disableI18n) {\n      return keyOrKeyArray;\n    }\n    return i18n.t(keyOrKeyArray, translateProps, fallbackOptions);\n  };\n  const translateAlert = ({ disableI18n, message, actionLabel, title, ...alert }) => ({\n    ...alert,\n    message: translate(message, alert, disableI18n),\n    title: translate(title, alert, disableI18n),\n    actionLabel: translate(actionLabel, alert, disableI18n),\n  })\n  // translate alerts\n  ;\n  onData(null, { alerts: alerts.map(translateAlert) });\n};\n\nexport const depsMapper = (context, actions) => ({\n  context: () => context,\n  dismissAlert: actions.alerts.dismiss,\n});\n\nexport default composeAll(\n  composeWithTracker(composer),\n  useDeps(depsMapper),\n)(AlertStack);\n"]}